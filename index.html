<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>BLE EMG Debug Receiver</title>
</head>
<body>
  <h2>EMG Debug 接收器</h2>
  <button onclick="connect()">連接藍牙</button>
  <pre id="output">尚未接收資料</pre>

  <script>
    let output = document.getElementById('output');

    async function connect() {
      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{ namePrefix: 'MLT' }],
          optionalServices: ['ffe0']
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService('ffe0');
        const charac = await service.getCharacteristic('ffe1');

        await charac.startNotifications();
        output.textContent = '已連線，等待資料...\n';

        charac.addEventListener('characteristicvaluechanged', event => {
          const value = new TextDecoder().decode(event.target.value);
          output.textContent += '收到：' + value + '\n';
        });

      } catch (error) {
        output.textContent += '錯誤：' + error + '\n';
      }
    }
  </script>
</body>
</html>
